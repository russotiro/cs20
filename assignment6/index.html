<!DOCTYPE html>
<html>
    <head>
        <title>Amicable Numbers</title>
        <style>
            input { margin: 10px; }
            h1,body { font-family: Verdana, serif; }
            div { margin-top: 20px; }
        </style>
    </head>
    <body>
        <h1>Are they amicable?</h1>
        <form name="amicable-input" action="./" method="get">
            1st number: <input type="text" name="first-num" id="first-num">
            <br />
            2nd number: <input type="text" name="second-num"
                               id="second-num"><br />
            <input type="button" value="Submit"
                   onClick="handleForm(this.form)" />
        </form>
        <div id="result-div"></div>
        <div id="factors-div"></div>
        <script>
            function handleForm(form) {
                first = document.getElementById("first-num").value;
                second = document.getElementById("second-num").value;

                // Testing:
                // first = 220;
                // second = 284;
                // first = 221;
                // second = 284;
                // first = 1046;
                // second = 240;

                displayStr = "The numbers: " + first + " and " + second +
                             " are ";
                if (!amicable(first, second))
                    displayStr += "not ";
                displayStr += "amicable<br />";
                document.getElementById("result-div").innerHTML = displayStr;
            }

            function amicable(num1, num2) {
                factors = [find_factors(num1), find_factors(num2)];
                factorsStr = "1st number factors: " + factors[0] + "<br />" +
                             "2nd number factors: " + factors[1];
                document.getElementById("factors-div").innerHTML = factorsStr;

                sum_of_factors = [];
                for (i = 0; i < 2; i++)
                    sum_of_factors[i] = factors[i].reduce(sumArray, 0);
                return sum_of_factors[0] == num2 || sum_of_factors[1] == num1;
            }

            function sumArray(closure, value) {
                return closure + value;
            }

            function find_factors(num) {
                factors = [];
                for (i = 1; i <= Math.floor(num / 2); i++)
                    if (num % i == 0)
                        factors.push(i);
                return factors;
            }
        </script>
    </body>
</html>
